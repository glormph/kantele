var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function s(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e,t){e.appendChild(t)}function r(e,t,n){e.insertBefore(t,n||null)}function c(e){e.parentNode.removeChild(e)}function o(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function u(e){return document.createTextNode(e)}function d(){return u(" ")}function p(){return u("")}function m(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function h(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e){const t=[];for(let n=0;n<e.length;n+=1)e[n].checked&&t.push(e[n].__value);return t}function _(e,t){t=""+t,e.data!==t&&(e.data=t)}function b(e,t){(null!=t||e.value)&&(e.value=t)}function v(e,t){for(let n=0;n<e.options.length;n+=1){const l=e.options[n];if(l.__value===t)return void(l.selected=!0)}}function w(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}let y;function j(e){y=e}function O(e){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.on_mount.push(e)}const k=[],x=[],$=[],q=[],C=Promise.resolve();let E=!1;function A(e){$.push(e)}function L(){const e=new Set;do{for(;k.length;){const e=k.shift();j(e),S(e.$$)}for(;x.length;)x.pop()();for(let t=0;t<$.length;t+=1){const n=$[t];e.has(n)||(n(),e.add(n))}$.length=0}while(k.length);for(;q.length;)q.pop()();E=!1}function S(e){null!==e.fragment&&(e.update(e.dirty),l(e.before_update),e.fragment&&e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(A))}const M=new Set;const N="undefined"!=typeof window?window:global;function T(e,t){e.$$.dirty||(k.push(e),E||(E=!0,C.then(L)),e.$$.dirty=n()),e.$$.dirty[t]=!0}function R(i,a,r,c,o,f){const u=y;j(i);const d=a.props||{},p=i.$$={fragment:null,ctx:null,props:f,update:e,not_equal:o,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:null};let m=!1;var h,g,_;p.ctx=r?r(i,d,(e,t,n=t)=>(p.ctx&&o(p.ctx[e],p.ctx[e]=n)&&(p.bound[e]&&p.bound[e](n),m&&T(i,e)),t)):d,p.update(),m=!0,l(p.before_update),p.fragment=!!c&&c(p.ctx),a.target&&(a.hydrate?p.fragment&&p.fragment.l((_=a.target,Array.from(_.childNodes))):p.fragment&&p.fragment.c(),a.intro&&((h=i.$$.fragment)&&h.i&&(M.delete(h),h.i(g))),function(e,n,i){const{fragment:a,on_mount:r,on_destroy:c,after_update:o}=e.$$;a&&a.m(n,i),A(()=>{const n=r.map(t).filter(s);c?c.push(...n):l(n),e.$$.on_mount=[]}),o.forEach(A)}(i,a.target,a.anchor),L()),j(u)}class F{$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx={})}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const z=5e3;async function P(e){let t;try{t=await e.json()}catch(t){return{ok:!1,error:"Server error encountered",status:e.status}}return t.ok=e.ok,t}async function D(e){let t;try{t=await fetch(e)}catch{return{ok:!1,error:"Kantele encountered a network error",status:!1}}return await P(t)}const{Object:H}=N;function I(e,t,n){const l=H.create(e);return l.ffilep=t[n],l}function U(e,t,n){const l=H.create(e);return l.resfile=t[n],l}function W(e,t,n){const l=H.create(e);return l.libfn=t[n],l}function B(e,t,n){const l=H.create(e);return l.filep=t[n],l}function Y(e,t,n){const l=H.create(e);return l.resfile=t[n],l}function K(e,t,n){const l=H.create(e);return l.libfn=t[n],l}function V(e,t,n){const l=H.create(e);return l.mfpkey=t[n],l}function J(e,t,n){const l=H.create(e);return l.filep=t[n],l}function X(e,t,n){const l=H.create(e);return l.flag=t[n],l}function Z(e,t,n){const l=H.create(e);return l.opt=t[n],l}function G(e,t,n){const l=H.create(e);return l.nf=t[n].nf,l.name=t[n].name,l.opts=t[n].opts,l}function Q(e,t,n){const l=H.create(e);return l.ch=t[n].ch,l.sample=t[n].sample,l}function ee(e,t,n){const l=H.create(e);return l.isoq=t[n],l.each_value_11=t,l.isoq_index=n,l}function te(e,t,n){const l=H.create(e);return l.fn=t[n],l.each_value_14=t,l.fn_index=n,l}function ne(e,t,n){const l=H.create(e);return l.sf=t[n],l}function le(e,t,n){const l=H.create(e);return l.ds=t[n],l.each_value_13=t,l.ds_index=n,l}function se(e,t,n){const l=H.create(e);return l.wfv=t[n],l}function ie(e,t,n){const l=H.create(e);return l.wfid=t[n],l}function ae(e,t,n){const l=H.create(e);return l.message=t[n],l}function re(e,t,n){const l=H.create(e);return l.link=t[n],l}function ce(e,t,n){const l=H.create(e);return l.error=t[n],l}function oe(e){let t,n=Object.entries(e.notif.errors).filter(ut).map(dt),l=[];for(let t=0;t<n.length;t+=1)l[t]=fe(ce(e,n,t));return{c(){t=f("div");for(let e=0;e<l.length;e+=1)l[e].c();h(t,"class","notification is-danger is-light")},m(e,n){r(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,s){if(e.Object||e.notif){let i;for(n=Object.entries(s.notif.errors).filter(ut).map(dt),i=0;i<n.length;i+=1){const a=ce(s,n,i);l[i]?l[i].p(e,a):(l[i]=fe(a),l[i].c(),l[i].m(t,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){e&&c(t),o(l,e)}}}function fe(e){let t,n,l=e.error+"";return{c(){t=f("div"),n=u(l)},m(e,l){r(e,t,l),a(t,n)},p(e,t){(e.Object||e.notif)&&l!==(l=t.error+"")&&_(n,l)},d(e){e&&c(t)}}}function ue(e){let t,n=Object.entries(e.notif.links).filter(pt).map(mt),l=[];for(let t=0;t<n.length;t+=1)l[t]=de(re(e,n,t));return{c(){t=f("div");for(let e=0;e<l.length;e+=1)l[e].c();h(t,"class","notification is-danger is-light errormsg svelte-5nys59")},m(e,n){r(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,s){if(e.Object||e.notif){let i;for(n=Object.entries(s.notif.links).filter(pt).map(mt),i=0;i<n.length;i+=1){const a=re(s,n,i);l[i]?l[i].p(e,a):(l[i]=de(a),l[i].c(),l[i].m(t,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){e&&c(t),o(l,e)}}}function de(e){let t,n,l,s,i;return{c(){t=f("div"),n=u("Click here: "),l=f("a"),s=u("here"),h(l,"target","_blank"),h(l,"href",i=e.link)},m(e,i){r(e,t,i),a(t,n),a(t,l),a(l,s)},p(e,t){(e.Object||e.notif)&&i!==(i=t.link)&&h(l,"href",i)},d(e){e&&c(t)}}}function pe(e){let t,n=Object.entries(e.notif.messages).filter(ht).map(gt),l=[];for(let t=0;t<n.length;t+=1)l[t]=me(ae(e,n,t));return{c(){t=f("div");for(let e=0;e<l.length;e+=1)l[e].c();h(t,"class","notification is-success is-light errormsg svelte-5nys59")},m(e,n){r(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,s){if(e.Object||e.notif){let i;for(n=Object.entries(s.notif.messages).filter(ht).map(gt),i=0;i<n.length;i+=1){const a=ae(s,n,i);l[i]?l[i].p(e,a):(l[i]=me(a),l[i].c(),l[i].m(t,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){e&&c(t),o(l,e)}}}function me(e){let t,n,l=e.message+"";return{c(){t=f("div"),n=u(l)},m(e,l){r(e,t,l),a(t,n)},p(e,t){(e.Object||e.notif)&&l!==(l=t.message+"")&&_(n,l)},d(e){e&&c(t)}}}function he(e){let t,n,l,s,i=e.allwfs[e.wfid].name+"";return{c(){t=f("option"),n=u(i),l=d(),t.__value=s=e.wfid,t.value=t.__value},m(e,s){r(e,t,s),a(t,n),a(t,l)},p(e,l){(e.allwfs||e.wforder)&&i!==(i=l.allwfs[l.wfid].name+"")&&_(n,i),e.wforder&&s!==(s=l.wfid)&&(t.__value=s),t.value=t.__value},d(e){e&&c(t)}}}function ge(e){let t,n=e.allwfs[e.config.wfid].versions,l=[];for(let t=0;t<n.length;t+=1)l[t]=be(se(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=p()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);r(e,t,n)},p(e,s){if(e.allwfs||e.config){let i;for(n=s.allwfs[s.config.wfid].versions,i=0;i<n.length;i+=1){const a=se(s,n,i);l[i]?l[i].p(e,a):(l[i]=be(a),l[i].c(),l[i].m(t.parentNode,t))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){o(l,e),e&&c(t)}}}function _e(e){let t;return{c(){(t=f("span")).textContent="LATEST:"},m(e,n){r(e,t,n)},d(e){e&&c(t)}}}function be(e){let t,n,l,s,i,o,p,m=e.wfv.date+"",h=e.wfv.name+"",g=e.wfv.latest&&_e();return{c(){t=f("option"),g&&g.c(),n=d(),l=u(m),s=u(" -- "),i=u(h),o=d(),t.__value=p=e.wfv,t.value=t.__value},m(e,c){r(e,t,c),g&&g.m(t,null),a(t,n),a(t,l),a(t,s),a(t,i),a(t,o)},p(e,s){s.wfv.latest?g||((g=_e()).c(),g.m(t,n)):g&&(g.d(1),g=null),(e.allwfs||e.config)&&m!==(m=s.wfv.date+"")&&_(l,m),(e.allwfs||e.config)&&h!==(h=s.wfv.name+"")&&_(i,h),(e.allwfs||e.config)&&p!==(p=s.wfv)&&(t.__value=p),t.value=t.__value},d(e){e&&c(t),g&&g.d()}}}function ve(e){let t,n,l,s,i,g,v,w,y,j,O,k,x,$,q,C,E,A,L,S,M,N,T,R,F,z,P,D,H,I,U,W=e.allwfs[e.config.wfid].wftype+"",Y=e.config.analysisname+"",K=Object.keys(e.isoquants).length,V=!("flags"in e.wf&&Object.keys(e.wf.flags).length),Z=Object.values(e.dsets),Q=[];for(let t=0;t<Z.length;t+=1)Q[t]=Se(le(e,Z,t));let ee=K&&Me(e),te=e.wf.multicheck,ne=[];for(let t=0;t<te.length;t+=1)ne[t]=He(G(e,te,t));let se=Object.entries(e.wf.flags),ie=[];for(let t=0;t<se.length;t+=1)ie[t]=Ie(X(e,se,t));let ae=V&&Ue(),re=e.wf.multifileparams,ce=[];for(let t=0;t<re.length;t+=1)ce[t]=Je(J(e,re,t));let oe=e.wf.fileparams,fe=[];for(let t=0;t<oe.length;t+=1)fe[t]=et(B(e,oe,t));let ue=e.wf.fixedfileparams.length&&tt(e);function de(e,t){return t.runButtonActive?it:t.postingAnalysis?st:lt}let pe=de(0,e),me=pe(e);return{c(){t=f("div"),n=f("input"),l=d(),s=f("div"),i=u("Full name will be "),g=f("code"),v=u(W),w=u("_"),y=u(Y),j=u("\n    This will be the folder name for the output and prefixed to the output filenames"),O=d(),(k=f("div")).textContent="Datasets",x=d();for(let e=0;e<Q.length;e+=1)Q[e].c();$=d(),ee&&ee.c(),q=d(),C=f("div"),(E=f("div")).textContent="Workflow parameters",A=d();for(let e=0;e<ne.length;e+=1)ne[e].c();L=d(),(S=f("label")).textContent="Config flags",M=d();for(let e=0;e<ie.length;e+=1)ie[e].c();N=d(),ae&&ae.c(),T=d(),R=f("div"),(F=f("div")).textContent="Input files",z=d();for(let e=0;e<ce.length;e+=1)ce[e].c();P=d();for(let e=0;e<fe.length;e+=1)fe[e].c();D=d(),ue&&ue.c(),H=d(),me.c(),I=p(),h(n,"type","text"),h(n,"class","input"),h(n,"placeholder","Please enter analysis name"),h(t,"class","field"),h(k,"class","title is-5"),h(E,"class","title is-5"),h(S,"class","label"),h(C,"class","box"),h(F,"class","title is-5"),h(R,"class","box"),U=m(n,"input",e.input_input_handler)},m(c,o){r(c,t,o),a(t,n),b(n,e.config.analysisname),a(t,l),a(t,s),a(s,i),a(s,g),a(g,v),a(g,w),a(g,y),a(s,j),r(c,O,o),r(c,k,o),r(c,x,o);for(let e=0;e<Q.length;e+=1)Q[e].m(c,o);r(c,$,o),ee&&ee.m(c,o),r(c,q,o),r(c,C,o),a(C,E),a(C,A);for(let e=0;e<ne.length;e+=1)ne[e].m(C,null);a(C,L),a(C,S),a(C,M);for(let e=0;e<ie.length;e+=1)ie[e].m(C,null);a(C,N),ae&&ae.m(C,null),r(c,T,o),r(c,R,o),a(R,F),a(R,z);for(let e=0;e<ce.length;e+=1)ce[e].m(R,null);a(R,P);for(let e=0;e<fe.length;e+=1)fe[e].m(R,null);r(c,D,o),ue&&ue.m(c,o),r(c,H,o),me.m(c,o),r(c,I,o)},p(e,t){if(e.config&&n.value!==t.config.analysisname&&b(n,t.config.analysisname),(e.allwfs||e.config)&&W!==(W=t.allwfs[t.config.wfid].wftype+"")&&_(v,W),e.config&&Y!==(Y=t.config.analysisname+"")&&_(y,Y),e.Object||e.dsets||e.matchedFr||e.frregex||e.matchFractions||e.updateIsoquant){let n;for(Z=Object.values(t.dsets),n=0;n<Z.length;n+=1){const l=le(t,Z,n);Q[n]?Q[n].p(e,l):(Q[n]=Se(l),Q[n].c(),Q[n].m($.parentNode,$))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=Z.length}if((e.Object||e.isoquants)&&(K=Object.keys(t.isoquants).length),K?ee?ee.p(e,t):((ee=Me(t)).c(),ee.m(q.parentNode,q)):ee&&(ee.d(1),ee=null),e.Object||e.wf||e.config){let n;for(te=t.wf.multicheck,n=0;n<te.length;n+=1){const l=G(t,te,n);ne[n]?ne[n].p(e,l):(ne[n]=He(l),ne[n].c(),ne[n].m(C,L))}for(;n<ne.length;n+=1)ne[n].d(1);ne.length=te.length}if(e.Object||e.wf||e.config){let n;for(se=Object.entries(t.wf.flags),n=0;n<se.length;n+=1){const l=X(t,se,n);ie[n]?ie[n].p(e,l):(ie[n]=Ie(l),ie[n].c(),ie[n].m(C,N))}for(;n<ie.length;n+=1)ie[n].d(1);ie.length=se.length}if((e.wf||e.Object)&&(V=!("flags"in t.wf&&Object.keys(t.wf.flags).length)),V?ae||((ae=Ue()).c(),ae.m(C,null)):ae&&(ae.d(1),ae=null),e.Object||e.config||e.wf||e.removeMultifile||e.addMultifile){let n;for(re=t.wf.multifileparams,n=0;n<re.length;n+=1){const l=J(t,re,n);ce[n]?ce[n].p(e,l):(ce[n]=Je(l),ce[n].c(),ce[n].m(R,P))}for(;n<ce.length;n+=1)ce[n].d(1);ce.length=re.length}if(e.config||e.wf){let n;for(oe=t.wf.fileparams,n=0;n<oe.length;n+=1){const l=B(t,oe,n);fe[n]?fe[n].p(e,l):(fe[n]=et(l),fe[n].c(),fe[n].m(R,null))}for(;n<fe.length;n+=1)fe[n].d(1);fe.length=oe.length}t.wf.fixedfileparams.length?ue?ue.p(e,t):((ue=tt(t)).c(),ue.m(H.parentNode,H)):ue&&(ue.d(1),ue=null),pe===(pe=de(0,t))&&me?me.p(e,t):(me.d(1),(me=pe(t))&&(me.c(),me.m(I.parentNode,I)))},d(e){e&&c(t),e&&c(O),e&&c(k),e&&c(x),o(Q,e),e&&c($),ee&&ee.d(e),e&&c(q),e&&c(C),o(ne,e),o(ie,e),ae&&ae.d(),e&&c(T),e&&c(R),o(ce,e),o(fe,e),e&&c(D),ue&&ue.d(e),e&&c(H),me.d(e),e&&c(I),U()}}}function we(e){let t,n,l,s,i,m,g,b,v,w,y,j,O,k,x,$,q,C,E,A,L,S,M,N,T,R,F,z=e.ds.proj+"",P=e.ds.exp+"",D=e.ds.run+"",H=e.ds.details.qtype+"",I=e.ds.details.instruments.join(", ")+"",U=!e.ds.prefrac&&je(e),W=!e.ds.filesaresets&&Oe(e);function B(e,t){return t.ds.prefrac?t.ds.hr?xe:ke:$e}let Y=B(0,e),K=Y(e),V=Object.entries(e.ds.details.nrstoredfiles),J=[];for(let t=0;t<V.length;t+=1)J[t]=qe(ne(e,V,t));let X=e.ds.details.nrstoredfiles.refined_mzML&&Ce(),Z=e.ds.prefrac&&Ee(e),G=e.ds.filesaresets&&Ae(e);return{c(){t=f("div"),n=f("div"),U&&U.c(),l=d(),W&&W.c(),s=d(),i=f("div"),m=f("span"),g=u(z),b=u(" // "),v=u(P),w=u(" // "),y=u(D),j=u(" //"),O=d(),K.c(),k=d(),x=f("div"),$=f("span"),q=u(H),C=d();for(let e=0;e<J.length;e+=1)J[e].c();E=d(),A=f("span"),L=u("// "),S=u(I),M=d(),X&&X.c(),N=d(),T=f("div"),Z&&Z.c(),R=d(),G&&G.c(),F=p(),h(i,"class","subtitle is-6 has-text-primary"),h(x,"class","subtitle is-6"),h(n,"class","column"),h(T,"class","column"),h(t,"class","columns")},m(e,c){r(e,t,c),a(t,n),U&&U.m(n,null),a(n,l),W&&W.m(n,null),a(n,s),a(n,i),a(i,m),a(m,g),a(m,b),a(m,v),a(m,w),a(m,y),a(m,j),a(i,O),K.m(i,null),a(n,k),a(n,x),a(x,$),a($,q),a(x,C);for(let e=0;e<J.length;e+=1)J[e].m(x,null);a(x,E),a(x,A),a(A,L),a(A,S),a(n,M),X&&X.m(n,null),a(t,N),a(t,T),Z&&Z.m(T,null),r(e,R,c),G&&G.m(e,c),r(e,F,c)},p(e,t){if(t.ds.prefrac?U&&(U.d(1),U=null):U?U.p(e,t):((U=je(t)).c(),U.m(n,l)),t.ds.filesaresets?W&&(W.d(1),W=null):W?W.p(e,t):((W=Oe(t)).c(),W.m(n,s)),(e.Object||e.dsets)&&z!==(z=t.ds.proj+"")&&_(g,z),(e.Object||e.dsets)&&P!==(P=t.ds.exp+"")&&_(v,P),(e.Object||e.dsets)&&D!==(D=t.ds.run+"")&&_(y,D),Y===(Y=B(0,t))&&K?K.p(e,t):(K.d(1),(K=Y(t))&&(K.c(),K.m(i,null))),(e.Object||e.dsets)&&H!==(H=t.ds.details.qtype+"")&&_(q,H),e.Object||e.dsets){let n;for(V=Object.entries(t.ds.details.nrstoredfiles),n=0;n<V.length;n+=1){const l=ne(t,V,n);J[n]?J[n].p(e,l):(J[n]=qe(l),J[n].c(),J[n].m(x,E))}for(;n<J.length;n+=1)J[n].d(1);J.length=V.length}(e.Object||e.dsets)&&I!==(I=t.ds.details.instruments.join(", ")+"")&&_(S,I),t.ds.details.nrstoredfiles.refined_mzML?X||((X=Ce()).c(),X.m(n,null)):X&&(X.d(1),X=null),t.ds.prefrac?Z?Z.p(e,t):((Z=Ee(t)).c(),Z.m(T,null)):Z&&(Z.d(1),Z=null),t.ds.filesaresets?G?G.p(e,t):((G=Ae(t)).c(),G.m(F.parentNode,F)):G&&(G.d(1),G=null)},d(e){e&&c(t),U&&U.d(),W&&W.d(),K.d(),o(J,e),X&&X.d(),Z&&Z.d(),e&&c(R),G&&G.d(e),e&&c(F)}}}function ye(e){let t,n,l,s,i,o,d,p,m=e.ds.proj+"",g=e.ds.run+"",b=e.ds.details.qtype+"",v=e.ds.details.instruments.join(",")+"";return{c(){t=f("span"),n=u(m),l=u(" // Labelcheck // "),s=u(g),i=u(" // "),o=u(b),d=u(" // "),p=u(v),h(t,"class","has-text-primary")},m(e,c){r(e,t,c),a(t,n),a(t,l),a(t,s),a(t,i),a(t,o),a(t,d),a(t,p)},p(e,t){(e.Object||e.dsets)&&m!==(m=t.ds.proj+"")&&_(n,m),(e.Object||e.dsets)&&g!==(g=t.ds.run+"")&&_(s,g),(e.Object||e.dsets)&&b!==(b=t.ds.details.qtype+"")&&_(o,b),(e.Object||e.dsets)&&v!==(v=t.ds.details.instruments.join(",")+"")&&_(p,v)},d(e){e&&c(t)}}}function je(e){let t,n,l,s;function i(){e.input_change_handler.call(t,e)}return{c(){t=f("input"),n=d(),(l=f("label")).textContent="Each file is a different sample",h(t,"type","checkbox"),h(l,"class","checkbox"),s=m(t,"change",i)},m(s,i){r(s,t,i),t.checked=e.ds.filesaresets,r(s,n,i),r(s,l,i)},p(n,l){e=l,(n.Object||n.dsets)&&(t.checked=e.ds.filesaresets)},d(e){e&&c(t),e&&c(n),e&&c(l),s()}}}function Oe(e){let t,n,s;function i(){e.input_input_handler_1.call(n,e)}return{c(){t=f("div"),h(n=f("input"),"type","text"),h(n,"class","input"),h(n,"placeholder","Name of set"),h(t,"class","field"),s=[m(n,"input",i),m(n,"change",e.updateIsoquant)]},m(l,s){r(l,t,s),a(t,n),b(n,e.ds.setname)},p(t,l){e=l,(t.Object||t.dsets)&&n.value!==e.ds.setname&&b(n,e.ds.setname)},d(e){e&&c(t),l(s)}}}function ke(e){let t,n,l=e.ds.prefrac+"";return{c(){t=f("span"),n=u(l)},m(e,l){r(e,t,l),a(t,n)},p(e,t){(e.Object||e.dsets)&&l!==(l=t.ds.prefrac+"")&&_(n,l)},d(e){e&&c(t)}}}function xe(e){let t,n,l=e.ds.hr+"";return{c(){t=f("span"),n=u(l)},m(e,l){r(e,t,l),a(t,n)},p(e,t){(e.Object||e.dsets)&&l!==(l=t.ds.hr+"")&&_(n,l)},d(e){e&&c(t)}}}function $e(e){let t,n,l=e.ds.dtype+"";return{c(){t=f("span"),n=u(l)},m(e,l){r(e,t,l),a(t,n)},p(e,t){(e.Object||e.dsets)&&l!==(l=t.ds.dtype+"")&&_(n,l)},d(e){e&&c(t)}}}function qe(e){let t,n,l,s,i,o,p=e.sf[1]+"",m=e.sf[0]+"";return{c(){t=f("span"),n=u("// "),l=u(p),s=d(),i=u(m),o=u(" files")},m(e,c){r(e,t,c),a(t,n),a(t,l),a(t,s),a(t,i),a(t,o)},p(e,t){(e.Object||e.dsets)&&p!==(p=t.sf[1]+"")&&_(l,p),(e.Object||e.dsets)&&m!==(m=t.sf[0]+"")&&_(i,m)},d(e){e&&c(t)}}}function Ce(e){let t;return{c(){(t=f("div")).innerHTML="<strong>Enforcing use of refined mzML(s)</strong>",h(t,"class","subtitle is-6")},m(e,n){r(e,t,n)},d(e){e&&c(t)}}}function Ee(e){let t,n,s,i,o,p,g,v,w,y=e.matchedFr[e.ds.id]+"";function j(){e.input_input_handler_2.call(i,e)}function O(...t){return e.change_handler_1(e,...t)}return{c(){t=f("div"),(n=f("label")).textContent="Regex for fraction detection",s=d(),i=f("input"),o=d(),p=f("span"),g=u(y),v=u(" fractions matched"),h(n,"class","label"),h(i,"type","text"),h(i,"class","input"),h(t,"class","field"),w=[m(i,"input",j),m(i,"change",O)]},m(l,c){r(l,t,c),a(t,n),a(t,s),a(t,i),b(i,e.frregex[e.ds.id]),r(l,o,c),r(l,p,c),a(p,g),a(p,v)},p(t,n){e=n,(t.frregex||t.Object||t.dsets)&&i.value!==e.frregex[e.ds.id]&&b(i,e.frregex[e.ds.id]),(t.matchedFr||t.Object||t.dsets)&&y!==(y=e.matchedFr[e.ds.id]+"")&&_(g,y)},d(e){e&&c(t),e&&c(o),e&&c(p),l(w)}}}function Ae(e){let t,n=e.ds.files,l=[];for(let t=0;t<n.length;t+=1)l[t]=Le(te(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=p()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);r(e,t,n)},p(e,s){if(e.Object||e.dsets){let i;for(n=s.ds.files,i=0;i<n.length;i+=1){const a=te(s,n,i);l[i]?l[i].p(e,a):(l[i]=Le(a),l[i].c(),l[i].m(t.parentNode,t))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){o(l,e),e&&c(t)}}}function Le(e){let t,n,l,s,i,o,p,g,v=e.fn.name+"";function w(){e.input_input_handler_3.call(o,e)}return{c(){t=f("div"),n=f("div"),l=u(v),s=d(),i=f("div"),o=f("input"),h(n,"class","column"),h(o,"type","text"),h(o,"class","input"),h(o,"placeholder",p=e.fn.sample),h(i,"class","column"),h(t,"class","columns"),g=m(o,"input",w)},m(c,f){r(c,t,f),a(t,n),a(n,l),a(t,s),a(t,i),a(i,o),b(o,e.fn.setname)},p(t,n){e=n,(t.Object||t.dsets)&&v!==(v=e.fn.name+"")&&_(l,v),(t.Object||t.dsets)&&o.value!==e.fn.setname&&b(o,e.fn.setname),(t.Object||t.dsets)&&p!==(p=e.fn.sample)&&h(o,"placeholder",p)},d(e){e&&c(t),g()}}}function Se(e){let t,n;function l(e,t){return(null==n||e.Object||e.dsets)&&(n=!("labelcheck"!==t.ds.dtype.toLowerCase())),n?ye:we}let s=l(null,e),i=s(e);return{c(){t=f("div"),i.c(),h(t,"class","box")},m(e,n){r(e,t,n),i.m(t,null)},p(e,n){s===(s=l(e,n))&&i?i.p(e,n):(i.d(1),(i=s(n))&&(i.c(),i.m(t,null)))},d(e){e&&c(t),i.d()}}}function Me(e){let t,n,l,s,i=1===Object.keys(e.isoquants).length,u=i&&Ne(e),p=Object.entries(e.isoquants),m=[];for(let t=0;t<p.length;t+=1)m[t]=Pe(ee(e,p,t));return{c(){t=f("div"),(n=f("div")).textContent="Isobaric quantification",l=d(),u&&u.c(),s=d();for(let e=0;e<m.length;e+=1)m[e].c();h(n,"class","title is-5"),h(t,"class","box")},m(e,i){r(e,t,i),a(t,n),a(t,l),u&&u.m(t,null),a(t,s);for(let e=0;e<m.length;e+=1)m[e].m(t,null)},p(e,n){if((e.Object||e.isoquants)&&(i=1===Object.keys(n.isoquants).length),i?u?u.p(e,n):((u=Ne(n)).c(),u.m(t,s)):u&&(u.d(1),u=null),e.sortChannels||e.Object||e.isoquants||e.mediansweep){let l;for(p=Object.entries(n.isoquants),l=0;l<p.length;l+=1){const s=ee(n,p,l);m[l]?m[l].p(e,s):(m[l]=Pe(s),m[l].c(),m[l].m(t,null))}for(;l<m.length;l+=1)m[l].d(1);m.length=p.length}},d(e){e&&c(t),u&&u.d(),o(m,e)}}}function Ne(e){let t,n,l,s,i;return{c(){t=f("div"),n=f("input"),l=d(),(s=f("label")).innerHTML='Use median sweeping (no predefined denominators)\n        <span class="icon is-small"><a title="Pick median denominator per PSM, only for single-set analyses"><i class="fa fa-question-circle"></i></a></span>',h(n,"type","checkbox"),h(s,"class","checkbox"),h(t,"class","field"),i=m(n,"change",e.input_change_handler_1)},m(i,c){r(i,t,c),a(t,n),n.checked=e.mediansweep,a(t,l),a(t,s)},p(e,t){e.mediansweep&&(n.checked=t.mediansweep)},d(e){e&&c(t),i()}}}function Te(e){let t;return{c(){(t=f("th")).innerHTML="<del>Denominator</del>"},m(e,n){r(e,t,n)},d(e){e&&c(t)}}}function Re(e){let t;return{c(){(t=f("th")).textContent="Denominator"},m(e,n){r(e,t,n)},d(e){e&&c(t)}}}function Fe(e){let t,n;function l(){e.input_change_handler_2.call(t,e)}return{c(){h(t=f("input"),"type","checkbox"),n=m(t,"change",l)},m(n,l){r(n,t,l),t.checked=e.isoq[1].denoms[e.ch]},p(n,l){e=l,(n.Object||n.isoquants||n.sortChannels)&&(t.checked=e.isoq[1].denoms[e.ch])},d(e){e&&c(t),n()}}}function ze(e){let t,n,l,s,i,o,p,g,v,w,y,j,O,k=e.ch+"",x=e.sample+"",$=!e.mediansweep&&Fe(e);function q(){e.input_input_handler_4.call(y,e)}return{c(){t=f("tr"),n=f("td"),$&&$.c(),l=d(),s=f("td"),i=u(k),o=d(),p=f("td"),g=u(x),v=d(),w=f("td"),y=f("input"),j=d(),h(y,"type","text"),h(y,"class","input"),h(y,"placeholder","Sample group or empty (e.g. CTRL, TREAT)"),O=m(y,"input",q)},m(c,f){r(c,t,f),a(t,n),$&&$.m(n,null),a(t,l),a(t,s),a(s,i),a(t,o),a(t,p),a(p,g),a(t,v),a(t,w),a(w,y),b(y,e.isoq[1].samplegroups[e.ch]),a(t,j)},p(t,l){(e=l).mediansweep?$&&($.d(1),$=null):$?$.p(t,e):(($=Fe(e)).c(),$.m(n,null)),(t.Object||t.isoquants)&&k!==(k=e.ch+"")&&_(i,k),(t.Object||t.isoquants)&&x!==(x=e.sample+"")&&_(g,x),(t.Object||t.isoquants||t.sortChannels)&&y.value!==e.isoq[1].samplegroups[e.ch]&&b(y,e.isoq[1].samplegroups[e.ch])},d(e){e&&c(t),$&&$.d(),O()}}}function Pe(e){let t,n,l,s,i,p,m,g,b,v,w,y,j,O,k,x,$,q,C=e.isoq[0]+"";function E(e,t){return t.mediansweep?Te:Re}let A=E(0,e),L=A(e),S=rt(e.isoq[1].channels),M=[];for(let t=0;t<S.length;t+=1)M[t]=ze(Q(e,S,t));return{c(){t=f("div"),n=u("Set: "),l=u(C),s=d(),i=f("div"),p=f("div"),m=f("table"),g=f("thead"),b=f("tr"),L.c(),v=d(),(w=f("th")).textContent="Channel",y=d(),(j=f("th")).textContent="Sample name",O=d(),(k=f("th")).innerHTML='Sample group \n                <span class="icon is-small"><a title="For DEqMS and PCA plots"><i class="fa fa-question-circle"></i></a></span>\n                LEAVE EMPTY FOR INTERNAL STANDARDS!',x=d(),$=f("tbody");for(let e=0;e<M.length;e+=1)M[e].c();q=d(),h(t,"class","has-text-primary title is-6"),h(m,"class","table is-striped is-narrow"),h(p,"class","column is-three-quarters"),h(i,"class","columns")},m(e,c){r(e,t,c),a(t,n),a(t,l),r(e,s,c),r(e,i,c),a(i,p),a(p,m),a(m,g),a(g,b),L.m(b,null),a(b,v),a(b,w),a(b,y),a(b,j),a(b,O),a(b,k),a(m,x),a(m,$);for(let e=0;e<M.length;e+=1)M[e].m($,null);a(i,q)},p(e,t){if((e.Object||e.isoquants)&&C!==(C=t.isoq[0]+"")&&_(l,C),A!==(A=E(0,t))&&(L.d(1),(L=A(t))&&(L.c(),L.m(b,v))),e.Object||e.isoquants||e.sortChannels||e.mediansweep){let n;for(S=rt(t.isoq[1].channels),n=0;n<S.length;n+=1){const l=Q(t,S,n);M[n]?M[n].p(e,l):(M[n]=ze(l),M[n].c(),M[n].m($,null))}for(;n<M.length;n+=1)M[n].d(1);M.length=S.length}},d(e){e&&c(t),e&&c(s),e&&c(i),L.d(),o(M,e)}}}function De(e){let t,n,l,s,i,o,p,g=e.opt[1]+"";return{c(){t=f("div"),n=f("input"),s=d(),i=f("label"),o=u(g),e.$$binding_groups[1].push(n),n.__value=l=[e.nf,e.opt[0]],n.value=n.__value,h(n,"type","checkbox"),h(i,"class","checkbox"),p=m(n,"change",e.input_change_handler_3)},m(l,c){r(l,t,c),a(t,n),n.checked=~e.config.multicheck.indexOf(n.__value),a(t,s),a(t,i),a(i,o)},p(e,t){e.config&&(n.checked=~t.config.multicheck.indexOf(n.__value)),(e.wf||e.Object)&&l!==(l=[t.nf,t.opt[0]])&&(n.__value=l),n.value=n.__value,(e.Object||e.wf)&&g!==(g=t.opt[1]+"")&&_(o,g)},d(l){l&&c(t),e.$$binding_groups[1].splice(e.$$binding_groups[1].indexOf(n),1),p()}}}function He(e){let t,n,l,s,i,p,m,g=e.name+"",b=e.nf+"",v=Object.entries(e.opts),w=[];for(let t=0;t<v.length;t+=1)w[t]=De(Z(e,v,t));return{c(){t=f("div"),n=f("label"),l=u(g),s=d(),i=f("code"),p=u(b),m=d();for(let e=0;e<w.length;e+=1)w[e].c();h(n,"class","label"),h(t,"class","field")},m(e,c){r(e,t,c),a(t,n),a(n,l),a(n,s),a(n,i),a(i,p),a(t,m);for(let e=0;e<w.length;e+=1)w[e].m(t,null)},p(e,n){if(e.wf&&g!==(g=n.name+"")&&_(l,g),e.wf&&b!==(b=n.nf+"")&&_(p,b),e.Object||e.wf||e.config){let l;for(v=Object.entries(n.opts),l=0;l<v.length;l+=1){const s=Z(n,v,l);w[l]?w[l].p(e,s):(w[l]=De(s),w[l].c(),w[l].m(t,null))}for(;l<w.length;l+=1)w[l].d(1);w.length=v.length}},d(e){e&&c(t),o(w,e)}}}function Ie(e){let t,n,l,s,i,o,p,g,b,v,w=e.flag[1]+"",y=e.flag[0]+"";return{c(){t=f("div"),n=f("input"),s=d(),i=f("label"),o=u(w),p=u(": "),g=f("code"),b=u(y),e.$$binding_groups[0].push(n),n.__value=l=e.flag[0],n.value=n.__value,h(n,"type","checkbox"),h(i,"class","checkbox"),v=m(n,"change",e.input_change_handler_4)},m(l,c){r(l,t,c),a(t,n),n.checked=~e.config.flags.indexOf(n.__value),a(t,s),a(t,i),a(i,o),a(t,p),a(t,g),a(g,b)},p(e,t){e.config&&(n.checked=~t.config.flags.indexOf(n.__value)),(e.Object||e.wf)&&l!==(l=t.flag[0])&&(n.__value=l),n.value=n.__value,(e.Object||e.wf)&&w!==(w=t.flag[1]+"")&&_(o,w),(e.Object||e.wf)&&y!==(y=t.flag[0]+"")&&_(b,y)},d(l){l&&c(t),e.$$binding_groups[0].splice(e.$$binding_groups[0].indexOf(n),1),v()}}}function Ue(e){let t;return{c(){(t=f("div")).textContent="No parameters for this workflow"},m(e,n){r(e,t,n)},d(e){e&&c(t)}}}function We(e){let t,n=e.wf.libfiles[e.filep.ftype],l=[];for(let t=0;t<n.length;t+=1)l[t]=Be(K(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=p()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);r(e,t,n)},p(e,s){if(e.wf){let i;for(n=s.wf.libfiles[s.filep.ftype],i=0;i<n.length;i+=1){const a=K(s,n,i);l[i]?l[i].p(e,a):(l[i]=Be(a),l[i].c(),l[i].m(t.parentNode,t))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){o(l,e),e&&c(t)}}}function Be(e){let t,n,l,s,i,o=e.libfn.name+"",d=e.libfn.desc+"";return{c(){t=f("option"),n=u(o),l=u(" -- "),s=u(d),t.__value=i=e.libfn.id,t.value=t.__value},m(e,i){r(e,t,i),a(t,n),a(t,l),a(t,s)},p(e,l){e.wf&&o!==(o=l.libfn.name+"")&&_(n,o),e.wf&&d!==(d=l.libfn.desc+"")&&_(s,d),e.wf&&i!==(i=l.libfn.id)&&(t.__value=i),t.value=t.__value},d(e){e&&c(t)}}}function Ye(e){let t,n=e.wf.prev_resultfiles,l=[];for(let t=0;t<n.length;t+=1)l[t]=Ke(Y(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=p()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);r(e,t,n)},p(e,s){if(e.wf){let i;for(n=s.wf.prev_resultfiles,i=0;i<n.length;i+=1){const a=Y(s,n,i);l[i]?l[i].p(e,a):(l[i]=Ke(a),l[i].c(),l[i].m(t.parentNode,t))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){o(l,e),e&&c(t)}}}function Ke(e){let t,n,l,s,i,o,d,p=e.resfile.analysisname+"",m=e.resfile.analysisdate+"",h=e.resfile.name+"";return{c(){t=f("option"),n=u(p),l=u(" -- "),s=u(m),i=u(" -- "),o=u(h),t.__value=d=e.resfile.id,t.value=t.__value},m(e,c){r(e,t,c),a(t,n),a(t,l),a(t,s),a(t,i),a(t,o)},p(e,l){e.wf&&p!==(p=l.resfile.analysisname+"")&&_(n,p),e.wf&&m!==(m=l.resfile.analysisdate+"")&&_(s,m),e.wf&&h!==(h=l.resfile.name+"")&&_(o,h),e.wf&&d!==(d=l.resfile.id)&&(t.__value=d),t.value=t.__value},d(e){e&&c(t)}}}function Ve(e){let t,n,s,i,o,g,b,w,y,j,O,k,x,$,q=e.mfpkey+"";function C(...t){return e.click_handler_1(e,...t)}let E=e.filep.ftype in e.wf.libfiles&&We(e),L=e.filep.allow_resultfile&&Ye(e);function S(){e.select_change_handler.call(j,e)}return{c(){t=f("label"),n=u("File nr. "),s=u(q),i=d(),o=f("span"),(g=f("a")).innerHTML='<i class="fa fa-trash-alt"></i>',b=d(),w=f("div"),y=f("div"),j=f("select"),(O=f("option")).textContent="Please select one",(k=f("option")).textContent="Do not use this parameter",E&&E.c(),x=p(),L&&L.c(),h(g,"title","Remove this file"),h(o,"class","icon is-small"),h(t,"class","label is-small"),O.disabled=!0,O.__value="",O.value=O.__value,k.__value="",k.value=k.__value,void 0===e.config.multifileparams[e.filep.nf][e.mfpkey]&&A(S),h(y,"class","select"),h(w,"class","field"),$=[m(g,"click",C),m(j,"change",S)]},m(l,c){r(l,t,c),a(t,n),a(t,s),a(t,i),a(t,o),a(o,g),r(l,b,c),r(l,w,c),a(w,y),a(y,j),a(j,O),a(j,k),E&&E.m(j,null),a(j,x),L&&L.m(j,null),v(j,e.config.multifileparams[e.filep.nf][e.mfpkey])},p(t,n){e=n,(t.Object||t.config||t.wf)&&q!==(q=e.mfpkey+"")&&_(s,q),e.filep.ftype in e.wf.libfiles?E?E.p(t,e):((E=We(e)).c(),E.m(j,x)):E&&(E.d(1),E=null),e.filep.allow_resultfile?L?L.p(t,e):((L=Ye(e)).c(),L.m(j,null)):L&&(L.d(1),L=null),(t.config||t.wf||t.Object)&&v(j,e.config.multifileparams[e.filep.nf][e.mfpkey])},d(e){e&&c(t),e&&c(b),e&&c(w),E&&E.d(),L&&L.d(),l($)}}}function Je(e){let t,n,l,s,i,g,b,v,w=e.filep.name+"";function y(...t){return e.click_handler(e,...t)}let j=Object.keys(e.config.multifileparams[e.filep.nf]),O=[];for(let t=0;t<j.length;t+=1)O[t]=Ve(V(e,j,t));return{c(){t=f("label"),n=u(w),l=d(),s=f("span"),(i=f("a")).innerHTML='<i class="fa fa-plus-square"></i>',g=d();for(let e=0;e<O.length;e+=1)O[e].c();b=p(),h(i,"title","Add another file"),h(s,"class","icon is-small"),h(t,"class","label"),v=m(i,"click",y)},m(e,c){r(e,t,c),a(t,n),a(t,l),a(t,s),a(s,i),r(e,g,c);for(let t=0;t<O.length;t+=1)O[t].m(e,c);r(e,b,c)},p(t,l){if(e=l,t.wf&&w!==(w=e.filep.name+"")&&_(n,w),t.config||t.wf||t.Object||t.removeMultifile){let n;for(j=Object.keys(e.config.multifileparams[e.filep.nf]),n=0;n<j.length;n+=1){const l=V(e,j,n);O[n]?O[n].p(t,l):(O[n]=Ve(l),O[n].c(),O[n].m(b.parentNode,b))}for(;n<O.length;n+=1)O[n].d(1);O.length=j.length}},d(e){e&&c(t),e&&c(g),o(O,e),e&&c(b),v()}}}function Xe(e){let t,n=e.wf.libfiles[e.filep.ftype],l=[];for(let t=0;t<n.length;t+=1)l[t]=Ze(W(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=p()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);r(e,t,n)},p(e,s){if(e.wf){let i;for(n=s.wf.libfiles[s.filep.ftype],i=0;i<n.length;i+=1){const a=W(s,n,i);l[i]?l[i].p(e,a):(l[i]=Ze(a),l[i].c(),l[i].m(t.parentNode,t))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){o(l,e),e&&c(t)}}}function Ze(e){let t,n,l,s,i,o=e.libfn.name+"",d=e.libfn.desc+"";return{c(){t=f("option"),n=u(o),l=u(" -- "),s=u(d),t.__value=i=e.libfn.id,t.value=t.__value},m(e,i){r(e,t,i),a(t,n),a(t,l),a(t,s)},p(e,l){e.wf&&o!==(o=l.libfn.name+"")&&_(n,o),e.wf&&d!==(d=l.libfn.desc+"")&&_(s,d),e.wf&&i!==(i=l.libfn.id)&&(t.__value=i),t.value=t.__value},d(e){e&&c(t)}}}function Ge(e){let t,n=e.wf.prev_resultfiles,l=[];for(let t=0;t<n.length;t+=1)l[t]=Qe(U(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=p()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);r(e,t,n)},p(e,s){if(e.wf){let i;for(n=s.wf.prev_resultfiles,i=0;i<n.length;i+=1){const a=U(s,n,i);l[i]?l[i].p(e,a):(l[i]=Qe(a),l[i].c(),l[i].m(t.parentNode,t))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){o(l,e),e&&c(t)}}}function Qe(e){let t,n,l,s,i,o,d,p=e.resfile.analysisname+"",m=e.resfile.analysisdate+"",h=e.resfile.name+"";return{c(){t=f("option"),n=u(p),l=u(" -- "),s=u(m),i=u(" -- "),o=u(h),t.__value=d=e.resfile.id,t.value=t.__value},m(e,c){r(e,t,c),a(t,n),a(t,l),a(t,s),a(t,i),a(t,o)},p(e,l){e.wf&&p!==(p=l.resfile.analysisname+"")&&_(n,p),e.wf&&m!==(m=l.resfile.analysisdate+"")&&_(s,m),e.wf&&h!==(h=l.resfile.name+"")&&_(o,h),e.wf&&d!==(d=l.resfile.id)&&(t.__value=d),t.value=t.__value},d(e){e&&c(t)}}}function et(e){let t,n,l,s,i,o,g,b,w,y,j,O=e.filep.name+"",k=e.filep.ftype in e.wf.libfiles&&Xe(e),x=e.filep.allow_resultfile&&Ge(e);function $(){e.select_change_handler_1.call(o,e)}return{c(){t=f("div"),n=f("label"),l=u(O),s=d(),i=f("div"),o=f("select"),(g=f("option")).textContent="Please select one",(b=f("option")).textContent="Do not use this parameter",k&&k.c(),w=p(),x&&x.c(),y=d(),h(n,"class","label"),g.disabled=!0,g.__value="",g.value=g.__value,b.__value="",b.value=b.__value,void 0===e.config.fileparams[e.filep.nf]&&A($),h(i,"class","select"),h(t,"class","field"),j=m(o,"change",$)},m(c,f){r(c,t,f),a(t,n),a(n,l),a(t,s),a(t,i),a(i,o),a(o,g),a(o,b),k&&k.m(o,null),a(o,w),x&&x.m(o,null),v(o,e.config.fileparams[e.filep.nf]),a(t,y)},p(t,n){e=n,t.wf&&O!==(O=e.filep.name+"")&&_(l,O),e.filep.ftype in e.wf.libfiles?k?k.p(t,e):((k=Xe(e)).c(),k.m(o,w)):k&&(k.d(1),k=null),e.filep.allow_resultfile?x?x.p(t,e):((x=Ge(e)).c(),x.m(o,null)):x&&(x.d(1),x=null),(t.config||t.wf)&&v(o,e.config.fileparams[e.filep.nf])},d(e){e&&c(t),k&&k.d(),x&&x.d(),j()}}}function tt(e){let t,n,l,s=e.wf.fixedfileparams,i=[];for(let t=0;t<s.length;t+=1)i[t]=nt(I(e,s,t));return{c(){t=f("div"),(n=f("div")).textContent="Predefined files",l=d();for(let e=0;e<i.length;e+=1)i[e].c();h(n,"class","title is-5"),h(t,"class","box")},m(e,s){r(e,t,s),a(t,n),a(t,l);for(let e=0;e<i.length;e+=1)i[e].m(t,null)},p(e,n){if(e.wf){let l;for(s=n.wf.fixedfileparams,l=0;l<s.length;l+=1){const a=I(n,s,l);i[l]?i[l].p(e,a):(i[l]=nt(a),i[l].c(),i[l].m(t,null))}for(;l<i.length;l+=1)i[l].d(1);i.length=s.length}},d(e){e&&c(t),o(i,e)}}}function nt(e){let t,n,l,s,i,o,p,m,g,b,v,w,y,j=e.ffilep.name+"",O=e.ffilep.fn+"",k=e.ffilep.desc+"";return{c(){t=f("div"),n=f("label"),l=u(j),s=d(),i=f("div"),o=f("select"),(p=f("option")).textContent="Fixed selection",m=f("option"),g=u(O),b=u(" -- "),v=u(k),y=d(),h(n,"class","label"),p.disabled=!0,p.__value="",p.value=p.__value,m.__value=w=e.ffilep.fn+" -- "+e.ffilep.desc,m.value=m.__value,h(i,"class","select"),h(t,"class","field")},m(e,c){r(e,t,c),a(t,n),a(n,l),a(t,s),a(t,i),a(i,o),a(o,p),a(o,m),a(m,g),a(m,b),a(m,v),a(t,y)},p(e,t){e.wf&&j!==(j=t.ffilep.name+"")&&_(l,j),e.wf&&O!==(O=t.ffilep.fn+"")&&_(g,O),e.wf&&k!==(k=t.ffilep.desc+"")&&_(v,k),e.wf&&w!==(w=t.ffilep.fn+" -- "+t.ffilep.desc)&&(m.__value=w),m.value=m.__value},d(e){e&&c(t)}}}function lt(t){let n;return{c(){(n=f("a")).textContent="Run analysis",h(n,"class","button is-primary"),h(n,"disabled","")},m(e,t){r(e,n,t)},p:e,d(e){e&&c(n)}}}function st(t){let n;return{c(){(n=f("a")).textContent="Run analysis",h(n,"class","button is-primary is-loading")},m(e,t){r(e,n,t)},p:e,d(e){e&&c(n)}}}function it(t){let n,l;return{c(){(n=f("a")).textContent="Run analysis",h(n,"class","button is-primary"),l=m(n,"click",t.runAnalysis)},m(e,t){r(e,n,t)},p:e,d(e){e&&c(n),l()}}}function at(t){let n,s,i,u,p,g,_,b,w,y,j,O,k,x,$,q,C,E,L,S,M,N,T,R,F,z,P,D=Object.values(t.notif.errors).some(ft),H=Object.values(t.notif.links).some(ot),I=Object.values(t.notif.messages).some(ct),U=D&&oe(t),W=H&&ue(t),B=I&&pe(t),Y=t.wforder,K=[];for(let e=0;e<Y.length;e+=1)K[e]=he(ie(t,Y,e));let V=t.config.wfid&&ge(t),J=t.wf&&ve(t);return{c(){n=f("div"),U&&U.c(),s=d(),W&&W.c(),i=d(),B&&B.c(),u=d(),p=f("div"),(g=f("div")).textContent="Analysis",_=d(),b=f("div"),(w=f("div")).innerHTML='<label class="label">Workflow:</label>',y=d(),j=f("div"),O=f("div"),k=f("div"),x=f("select"),($=f("option")).textContent="Select workflow";for(let e=0;e<K.length;e+=1)K[e].c();C=d(),(E=f("div")).innerHTML='<label class="label">Workflow version:</label>',L=d(),S=f("div"),M=f("div"),N=f("div"),T=f("select"),(R=f("option")).textContent="Select workflow version",V&&V.c(),z=d(),J&&J.c(),h(n,"class","errormsg svelte-5nys59"),h(g,"class","title is-5"),h(w,"class","field-label is-normal"),$.disabled=!0,$.__value=q=!1,$.value=$.__value,void 0===t.config.wfid&&A(()=>t.select0_change_handler.call(x)),h(k,"class","select"),h(O,"class","field"),h(j,"class","field-body"),h(E,"class","field-label is-normal"),R.disabled=!0,R.__value=F=!1,R.value=R.__value,void 0===t.config.wfversion&&A(()=>t.select1_change_handler.call(T)),h(N,"class","select"),h(M,"class","field"),h(S,"class","field-body"),h(b,"class","field is-horizontal"),h(p,"class","content"),P=[m(x,"change",t.select0_change_handler),m(x,"change",t.change_handler),m(T,"change",t.select1_change_handler),m(N,"change",t.fetchWorkflow)]},m(e,l){r(e,n,l),U&&U.m(n,null),a(n,s),W&&W.m(n,null),a(n,i),B&&B.m(n,null),r(e,u,l),r(e,p,l),a(p,g),a(p,_),a(p,b),a(b,w),a(b,y),a(b,j),a(j,O),a(O,k),a(k,x),a(x,$);for(let e=0;e<K.length;e+=1)K[e].m(x,null);v(x,t.config.wfid),a(b,C),a(b,E),a(b,L),a(b,S),a(S,M),a(M,N),a(N,T),a(T,R),V&&V.m(T,null),v(T,t.config.wfversion),a(p,z),J&&J.m(p,null)},p(e,t){if((e.Object||e.notif)&&(D=Object.values(t.notif.errors).some(ft)),D?U?U.p(e,t):((U=oe(t)).c(),U.m(n,s)):U&&(U.d(1),U=null),(e.Object||e.notif)&&(H=Object.values(t.notif.links).some(ot)),H?W?W.p(e,t):((W=ue(t)).c(),W.m(n,i)):W&&(W.d(1),W=null),(e.Object||e.notif)&&(I=Object.values(t.notif.messages).some(ct)),I?B?B.p(e,t):((B=pe(t)).c(),B.m(n,null)):B&&(B.d(1),B=null),e.wforder||e.allwfs){let n;for(Y=t.wforder,n=0;n<Y.length;n+=1){const l=ie(t,Y,n);K[n]?K[n].p(e,l):(K[n]=he(l),K[n].c(),K[n].m(x,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=Y.length}e.config&&v(x,t.config.wfid),t.config.wfid?V?V.p(e,t):((V=ge(t)).c(),V.m(T,null)):V&&(V.d(1),V=null),e.config&&v(T,t.config.wfversion),t.wf?J?J.p(e,t):((J=ve(t)).c(),J.m(p,null)):J&&(J.d(1),J=null)},i:e,o:e,d(e){e&&c(n),U&&U.d(),W&&W.d(),B&&B.d(),e&&c(u),e&&c(p),o(K,e),V&&V.d(),J&&J.d(),l(P)}}}function rt(e){return Object.entries(e).sort((e,t)=>e[0].replace("N","A")>t[0].replace("N","A")).map(e=>({ch:e[0],sample:e[1]}))}const ct=e=>1===e,ot=e=>1===e,ft=e=>1===e,ut=e=>1==e[1],dt=e=>e[0],pt=e=>1==e[1],mt=e=>e[0],ht=e=>1==e[1],gt=e=>e[0];function _t(e,t,n){let l={errors:{},messages:{},links:{}},s=!0,i=!1,a={},r=!1,c=[],o={},f={},u=!1,d={wfid:!1,wfversion:!1,analysisname:"",flags:[],multicheck:[],fileparams:{},multifileparams:{},v1:!1,v2:!1,version_dep:{v1:{instype:!1,dtype:!1}}},p={},m={};function h(e,t){delete d.multifileparams[e][t];let l={};Object.keys(d.multifileparams[e]).forEach((t,n)=>{l[n]=d.multifileparams[e][t]}),n("config",d.multifileparams[e]=l,d)}function _(e){const t=Object.keys(d.multifileparams[e]).map(e=>+e),l=t.length?Math.max(...t)+1:0;n("config",d.multifileparams[e][l]="",d)}function b(e){let t=new Set;for(let n of e.files){const l=n.name.match(RegExp(m[e.id]));l?(n.fr=l[1],t.add(l[1])):n.fr="NA"}n("matchedFr",p[e.id]=t.size,p)}O(async()=>{n("frregex",m=Object.fromEntries(dsids.map(e=>[e,".*fr([0-9]+).*mzML$"]))),async function(){let e=new URL("/analysis/workflows",document.location);const t=await D(e);if("error"in t){const e=`While fetching workflows, encountered: ${t.error}`;n("notif",l.errors[e]=1,l),setTimeout(function(e){n("notif",l.errors[e]=0,l)},z,e)}else n("allwfs",a=t.allwfs),n("wforder",c=t.order)}()});const v=[[],[]];return{notif:l,runButtonActive:s,postingAnalysis:i,allwfs:a,wf:r,wforder:c,dsets:o,isoquants:f,mediansweep:u,config:d,matchedFr:p,frregex:m,runAnalysis:async function(){if(!function(){n("notif",l={errors:{},messages:{},links:{}});const e=RegExp("^[a-z0-9_-]+$","i");return d.analysisname?e.test(d.analysisname)||n("notif",l.errors["Analysisname may only contain a-z 0-9 _ -"]=1,l):n("notif",l.errors["Analysisname must be filled in"]=1,l),d.wfid||n("notif",l.errors["You must select a workflow"]=1,l),d.wfversion||n("notif",l.errors["You must select a workflow version"]=1,l),Object.values(o).forEach(t=>{"labelcheck"===d.version_dep.v1.dtype.toLowerCase()||t.filesaresets||t.setname?t.filesaresets?t.files.filter(e=>!e.setname).length&&n("notif",l.errors[`File ${fn.name} needs to have a setname`]=1,l):t.setname&&!e.test(t.setname)&&n("notif",l.errors[`Dataset ${t.proj} - ${t.exp} - ${t.run} needs to have another set name: only a-z 0-9 _ are allowed`]=1,l):n("notif",l.errors[`Dataset ${t.proj} - ${t.exp} - ${t.run} needs to have a set name`]=1,l)}),Object.entries(f).forEach(([t,s])=>{Object.entries(s.samplegroups).forEach(([s,i])=>{i&&!e.test(i)&&n("notif",l.errors[`Incorrect sample group name for set ${t}, channel ${s}, only A-Z a-z 0-9 _ are allowed`]=1,l)})}),0===Object.keys(l.errors).length}())return!1;n("runButtonActive",s=!1),n("postingAnalysis",i=!0),n("notif",l.messages["Validated data"]=1,l);let e=Object.fromEntries(Object.entries(d.fileparams).filter(([e,t])=>t));r.fixedfileparams.forEach(t=>{e[t.nf]=t.id});let t=Object.fromEntries(Object.entries(d.multifileparams).map(([e,t])=>[e,Object.values(t).filter(e=>e)]).filter(([e,t])=>t.length)),c={};Object.values(o).filter(e=>e.filesaresets).forEach(e=>{Object.assign(c,Object.fromEntries(e.files.map(e=>[e.id,e.setname])))}),Object.values(o).filter(e=>!e.filesaresets).forEach(e=>{Object.assign(c,Object.fromEntries(e.files.map(t=>[t.id,e.setname])))});const p=Object.fromEntries(Object.values(o).flatMap(e=>e.files.map(e=>[e.id,e.fr])));n("notif",l.messages[`${Object.keys(c).length} set(s) found`]=1,l),n("notif",l.messages[`Using ${Object.keys(o).length} dataset(s)`]=1,l),l.messages[`${Object.keys(e).length} other inputfiles found`];let m={setnames:c,dsids:Object.keys(o),fractions:p,singlefiles:e,multifiles:t,wfid:d.wfid,nfwfvid:d.wfversion.id,analysisname:`${a[d.wfid].wftype}_${d.analysisname}`,strips:{},params:{flags:d.flags,multi:d.multicheck.reduce((e,t)=>(e[t[0]].push(t[1]),e),Object.fromEntries(d.multicheck.map(e=>[e[0],[]])))}};d.v1&&(m.params.inst=["--instrument",d.version_dep.v1.instype],m.params.quant="labelfree"===d.version_dep.v1.qtype?[]:["--isobaric",d.version_dep.v1.qtype]),Object.values(o).forEach(e=>{m.strips[e.id]=e.hr?e.hr:!!e.prefrac&&"unknown_plate"});let h=Object.entries(f).map(([e,t])=>[e,Object.entries(t.denoms).filter(([e,t])=>t).map(([e,t])=>e),t.chemistry]);(h=h.filter(([e,t,n])=>t.length>0)).length&&!u&&d.v1?m.params.denoms=["--denoms",h.map(([e,t,n])=>`${e}:${t.join(":")}`).join(" ")]:!h.length||u||d.v1||(m.params.denoms=["--isobaric",h.map(([e,t,n])=>`${e}:${n}:${t.join(":")}`).join(" ")]);let g=Object.entries(f).flatMap(([e,t])=>Object.entries(t.channels).map(([n,l])=>[n,e,l,t.samplegroups[n]]).sort((e,t)=>e[0].replace("N","A")>t[0].replace("N","A")));m.sampletable=g.map(e=>e.slice(0,3).concat(e[3]?e[3]:"X__POOL")),n("notif",l.messages[`Posting analysis job for ${this.analysisname}`]=1,l);const _=await async function(e,t){let n;try{n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch{return{ok:!1,error:"Kantele encountered a network error",status:!1}}return await P(n)}("/analysis/run/",m);_.error?(n("notif",l.errors[_.error]=1,l),"link"in _&&n("notif",l.links[_.link]=1,l)):window.location.href="/?tab=searches",n("postingAnalysis",i=!1),n("runButtonActive",s=!0)},fetchWorkflow:async function(){let e=new URL("/analysis/workflow",document.location);const t={dsids:dsids.join(","),wfvid:d.wfversion.id};e.search=new URLSearchParams(t).toString();const s=await D(e);if("error"in s){const e=`While fetching workflow versions, encountered: ${s.error}`;n("notif",l.errors[e]=1,l),setTimeout(function(e){n("notif",l.errors[e]=0,l)},z,e)}else n("wf",r=s.wf),n("config",d.v1=1===r.analysisapi,d),n("config",d.v2=2===r.analysisapi,d);r.multifileparams.length&&n("config",d.multifileparams=Object.fromEntries(r.multifileparams.map(e=>[e.nf,{0:""}])),d),async function(){let e=new URL("/analysis/dsets/",document.location);const t={dsids:dsids.join(",")};e.search=new URLSearchParams(t).toString();const s=await D(e);if(s.error){const e=s.errmsg;n("notif",l.errors[e]=1,l),setTimeout(function(e){n("notif",l.errors[e]=0,l)},z,e)}else{n("dsets",o=s.dsets),Object.entries(o).filter(e=>e[1].prefrac).forEach(e=>b(o[e[0]])),Object.entries(o).forEach(e=>{e.filesaresets=!1,e.setname=""});const e=new Set(Object.values(o).map(e=>e.dtype.toLowerCase()));n("config",d.version_dep.v1.dtype=e.size>1?"mixed":e.keys().next().value,d);const t=new Set(Object.values(o).map(e=>e.details.qtypeshort));d.v1&&t.size>1?n("notif",l.errors["Mixed quant types detected, cannot use those in single run, use more advanced pipeline version"]=1,l):n("config",d.version_dep.v1.qtype=t.keys().next().value,d);const i=new Set(Object.values(o).flatMap(e=>e.details.instrument_types).map(e=>e.toLowerCase()));d.v1&&i.size>1?n("notif",l.errors["Mixed instrument types detected, cannot use those in single run, use more advanced pipeline version"]=1,l):n("config",d.version_dep.v1.instype=i.keys().next().value,d)}}()},removeMultifile:h,addMultifile:_,matchFractions:b,updateIsoquant:function(){Object.values(o).forEach(e=>{const t=`Sample set mixing error! Channels for datasets with setname ${e.setname} are not identical!`;n("notif",l.errors[t]=0,l),!e.setname||e.setname in f?e.setname&&e.setname in f&&f[e.setname].channels!==e.details.channels&&n("notif",l.errors[t]=1,l):n("isoquants",f[e.setname]={chemistry:e.details.qtypeshort,channels:e.details.channels,samplegroups:Object.fromEntries(Object.keys(e.details.channels).map(e=>[e,""])),denoms:Object.fromEntries(Object.keys(e.details.channels).map(e=>[e,!1]))},f)});const e=new Set(Object.values(o).map(e=>e.setname).filter(e=>e));Object.keys(f).filter(t=>!e.has(t)).forEach(e=>{delete f[e]}),n("isoquants",f=Object.assign({},f))},select0_change_handler:function(){d.wfid=w(this),n("config",d),n("wforder",c)},change_handler:e=>n("wf",r=n("config",d.wfversion=!1,d)),select1_change_handler:function(){d.wfversion=w(this),n("config",d),n("wforder",c)},input_input_handler:function(){d.analysisname=this.value,n("config",d),n("wforder",c)},input_change_handler:function({ds:e}){e.filesaresets=this.checked,n("Object",Object),n("dsets",o),n("wf",r)},input_input_handler_1:function({ds:e}){e.setname=this.value,n("Object",Object),n("dsets",o),n("wf",r)},input_input_handler_2:function({ds:e}){m[e.id]=this.value,n("frregex",m),n("Object",Object),n("dsets",o),n("wf",r)},change_handler_1:({ds:e},t)=>b(e),input_input_handler_3:function({fn:e}){e.setname=this.value,n("Object",Object),n("dsets",o),n("wf",r)},input_change_handler_1:function(){u=this.checked,n("mediansweep",u)},input_change_handler_2:function({isoq:e,ch:t}){e[1].denoms[t]=this.checked,n("Object",Object),n("isoquants",f),n("sortChannels",rt),n("wf",r)},input_input_handler_4:function({isoq:e,ch:t}){e[1].samplegroups[t]=this.value,n("Object",Object),n("isoquants",f),n("sortChannels",rt),n("wf",r)},input_change_handler_3:function(){d.multicheck=g(v[1]),n("config",d),n("wforder",c)},input_change_handler_4:function(){d.flags=g(v[0]),n("config",d),n("wforder",c)},click_handler:({filep:e},t)=>_(e.nf),click_handler_1:({filep:e,mfpkey:t},n)=>h(e.nf,t),select_change_handler:function({filep:e,mfpkey:t}){d.multifileparams[e.nf][t]=w(this),n("config",d),n("wf",r),n("Object",Object),n("wforder",c)},select_change_handler_1:function({filep:e}){d.fileparams[e.nf]=w(this),n("config",d),n("wf",r),n("wforder",c)},$$binding_groups:v}}return new class extends F{constructor(e){super(),R(this,e,_t,at,i,{})}}({target:document.querySelector("#apps")})}();
//# sourceMappingURL=bundle.js.map
